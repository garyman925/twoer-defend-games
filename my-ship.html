<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„æˆ°æ©Ÿ - å‡ç´šç³»çµ±</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Squada+One&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* é ‚éƒ¨å°èˆª */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #00ffff;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #00ffff;
            font-size: 2rem;
            font-family: 'Squada One', cursive;
        }

        .back-btn {
            padding: 12px 24px;
            background: linear-gradient(0deg, #000000c4 0%, #009fb991 100%);
            border: none;
            border-radius: 8px;
            box-shadow: 0 0 0 4px #ffffff36;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        /* ç©å®¶ç‹€æ…‹é¢æ¿ */
        .player-stats {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #009fb9;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: rgba(0, 159, 185, 0.1);
            border-radius: 8px;
        }

        .stat-label {
            color: #00ffff;
            font-weight: bold;
        }

        .stat-value {
            color: #ffff00;
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* å‡ç´šå€åŸŸ */
        .upgrade-section {
            margin-bottom: 40px;
        }

        .section-title {
            color: #00ffff;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #009fb9;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-icon {
            font-size: 1.8rem;
        }

        .upgrade-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        /* è£å‚™æ§½ä½å€åŸŸ */
        .loadout-section {
            margin-bottom: 40px;
        }

        .loadout-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        /* è£å‚™æ§½ä½å¡ç‰‡ */
        .loadout-slot {
            background: rgba(0, 159, 185, 0.1);
            border: 2px solid #009fb9;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .loadout-slot:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 255, 255, 0.3);
            border-color: #00ffff;
        }

        .slot-number {
            position: absolute;
            top: 8px;
            left: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: #ffd93d;
            font-size: 14px;
            font-weight: bold;
            padding: 4px 10px;
            border-radius: 6px;
            border: 1px solid #ffd93d;
            font-family: 'Squada One', cursive;
        }

        .slot-icon {
            font-size: 48px;
            margin: 10px 0;
            filter: drop-shadow(0 0 10px rgba(0, 255, 255, 0.5));
        }

        .slot-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-family: 'Squada One', cursive;
        }

        .slot-stats {
            font-size: 0.9rem;
            color: #a0a0a0;
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .slot-stat-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }

        .change-btn {
            width: 100%;
            padding: 8px 16px;
            background: linear-gradient(0deg, #000000c4 0%, #009fb991 100%);
            border: none;
            border-radius: 6px;
            box-shadow: 0 0 0 2px #ffffff36;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .change-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.4);
        }

        /* é¸æ“‡å°è©±æ¡† */
        .dialog-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .dialog-overlay.active {
            display: flex;
        }

        .dialog-box {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            border: 3px solid #00ffff;
            border-radius: 16px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.5);
        }

        .dialog-header {
            padding: 20px;
            background: rgba(0, 159, 185, 0.2);
            border-bottom: 2px solid #009fb9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dialog-title {
            font-size: 1.5rem;
            color: #00ffff;
            font-family: 'Squada One', cursive;
        }

        .dialog-close {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 1.5rem;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .dialog-close:hover {
            background: rgba(255, 0, 0, 0.3);
            transform: scale(1.1);
        }

        .dialog-content {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }

        .option-item {
            background: rgba(0, 159, 185, 0.1);
            border: 2px solid #009fb9;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-item:hover {
            transform: translateX(5px);
            border-color: #00ffff;
            box-shadow: 0 4px 16px rgba(0, 255, 255, 0.3);
        }

        .option-item.selected {
            border-color: #ffd93d;
            background: rgba(255, 217, 61, 0.15);
            box-shadow: 0 0 20px rgba(255, 217, 61, 0.4);
        }

        .option-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .option-icon {
            font-size: 40px;
            flex-shrink: 0;
        }

        .option-details {
            flex: 1;
        }

        .option-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 4px;
            font-family: 'Squada One', cursive;
        }

        .option-desc {
            font-size: 0.9rem;
            color: #a0a0a0;
            margin-bottom: 8px;
        }

        .option-stats {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: #00ffff;
        }

        .option-badge {
            background: rgba(255, 217, 61, 0.2);
            color: #ffd93d;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: bold;
            border: 1px solid #ffd93d;
        }

        .option-badge.locked {
            background: rgba(255, 0, 0, 0.2);
            color: #ff5555;
            border-color: #ff5555;
        }

        .dialog-footer {
            padding: 16px 20px;
            background: rgba(0, 0, 0, 0.4);
            border-top: 2px solid #009fb9;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .dialog-btn {
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Squada One', cursive;
        }

        .dialog-btn-primary {
            background: linear-gradient(0deg, #000000c4 0%, #009fb991 100%);
            box-shadow: 0 0 0 2px #ffffff36;
            color: white;
        }

        .dialog-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.4);
        }

        .dialog-btn-secondary {
            background: rgba(100, 100, 100, 0.5);
            color: white;
        }

        .dialog-btn-secondary:hover {
            background: rgba(150, 150, 150, 0.5);
        }

        .upgrade-card {
            background: rgba(0, 159, 185, 0.1);
            border: 2px solid #009fb9;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .upgrade-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, transparent, rgba(0, 255, 255, 0.3), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .upgrade-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 255, 255, 0.2);
        }

        .upgrade-card:hover::before {
            opacity: 1;
        }

        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .upgrade-name {
            font-size: 1.3rem;
            color: #ffffff;
            font-weight: bold;
        }

        .upgrade-level {
            background: #009fb9;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: white;
        }

        .upgrade-stats {
            margin: 16px 0;
        }

        .upgrade-stat {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 159, 185, 0.3);
        }

        .upgrade-stat:last-child {
            border-bottom: none;
        }

        .current-value {
            color: #ffffff;
        }

        .next-value {
            color: #00ff00;
            font-weight: bold;
        }

        .upgrade-progress {
            margin: 16px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffff, #009fb9);
            transition: width 0.3s ease;
        }

        .upgrade-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(0deg, #000000c4 0%, #009fb991 100%);
            border: none;
            border-radius: 8px;
            box-shadow: 0 0 0 2px #ffffff36;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 12px;
        }

        .upgrade-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 255, 255, 0.3);
        }

        .upgrade-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .upgrade-cost {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }

        .cost-icon {
            color: #ffff00;
        }

        /* æˆ°æ©Ÿé è¦½å€ */
        .ship-preview {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #009fb9;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
        }

        .ship-image {
            max-width: 300px;
            margin: 0 auto;
            filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.5));
        }

        .ship-name {
            font-size: 2rem;
            color: #00ffff;
            margin-top: 20px;
            font-family: 'Squada One', cursive;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .upgrade-grid {
                grid-template-columns: 1fr;
            }

            .player-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é ‚éƒ¨å°èˆª -->
        <div class="header">
            <h1>ğŸš€ æˆ‘çš„æˆ°æ©Ÿ</h1>
            <button class="back-btn" onclick="window.close()">â† è¿”å›éŠæˆ²</button>
        </div>

        <!-- æˆ°æ©Ÿé è¦½ -->
        <div class="ship-preview">
            <img src="assets/sprites/player/blue/blue-ship.png" alt="æˆ‘çš„æˆ°æ©Ÿ" class="ship-image" style="width: 200px;" onerror="this.style.display='none'">
            <div class="ship-name">è—è‰²é–ƒé›»æˆ°æ©Ÿ</div>
        </div>

        <!-- ç©å®¶ç‹€æ…‹ -->
        <div class="player-stats">
            <div class="stat-item">
                <span class="stat-label">ğŸ’° é‡‘å¹£</span>
                <span class="stat-value" id="player-money">5000</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">â­ ç¸½ç­‰ç´š</span>
                <span class="stat-value" id="total-level">12</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ğŸ† å‹å ´</span>
                <span class="stat-value" id="wins">25</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ğŸ’€ æ“Šæ®ºæ•¸</span>
                <span class="stat-value" id="kills">1547</span>
            </div>
        </div>

        <!-- æ­¦å™¨è£å‚™å€ -->
        <div class="loadout-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ”«</span>
                æ­¦å™¨è£å‚™æ§½ <span style="font-size: 0.9rem; color: #a0a0a0;">(æˆ°é¬¥ä¸­å¯æŒ‰ 1/2/3 åˆ‡æ›)</span>
            </h2>
            <div class="loadout-grid" id="weapon-loadout">
                <!-- æ­¦å™¨æ§½ä½å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>

        <!-- ç‚®å¡”è£å‚™å€ -->
        <div class="loadout-section">
            <h2 class="section-title">
                <span class="section-icon">ğŸ—ï¸</span>
                ç‚®å¡”è£å‚™æ§½ <span style="font-size: 0.9rem; color: #a0a0a0;">(æº–å‚™éšæ®µæ”¾ç½®)</span>
            </h2>
            <div class="loadout-grid" id="tower-loadout">
                <!-- ç‚®å¡”æ§½ä½å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>

        <!-- å‡ç´šå€åŸŸ -->
        <div class="upgrade-section">
            <h2 class="section-title">
                <span class="section-icon">âš¡</span>
                æˆ°æ©Ÿå±¬æ€§å‡ç´š
            </h2>
            <div class="upgrade-grid">
                <!-- ç”Ÿå‘½å€¼å‡ç´šå¡ -->
                <div class="upgrade-card">
                    <div class="upgrade-header">
                        <span class="upgrade-name">â¤ï¸ ç”Ÿå‘½å€¼</span>
                        <span class="upgrade-level">Lv.3</span>
                    </div>
                    <div class="upgrade-stats">
                        <div class="upgrade-stat">
                            <span>ç•¶å‰å€¼</span>
                            <span class="current-value">150 HP</span>
                        </div>
                        <div class="upgrade-stat">
                            <span>å‡ç´šå¾Œ</span>
                            <span class="next-value">+30 â†’ 180 HP</span>
                        </div>
                    </div>
                    <div class="upgrade-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 60%;"></div>
                        </div>
                    </div>
                    <button class="upgrade-btn">
                        <span class="upgrade-cost">
                            <span class="cost-icon">ğŸ’°</span>
                            <span>300 é‡‘å¹£</span>
                        </span>
                    </button>
                </div>

                <!-- æ”»æ“ŠåŠ›å‡ç´šå¡ -->
                <div class="upgrade-card">
                    <div class="upgrade-header">
                        <span class="upgrade-name">âš”ï¸ æ”»æ“ŠåŠ›</span>
                        <span class="upgrade-level">Lv.4</span>
                    </div>
                    <div class="upgrade-stats">
                        <div class="upgrade-stat">
                            <span>ç•¶å‰å€¼</span>
                            <span class="current-value">25 DMG</span>
                        </div>
                        <div class="upgrade-stat">
                            <span>å‡ç´šå¾Œ</span>
                            <span class="next-value">+8 â†’ 33 DMG</span>
                        </div>
                    </div>
                    <div class="upgrade-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 80%;"></div>
                        </div>
                    </div>
                    <button class="upgrade-btn">
                        <span class="upgrade-cost">
                            <span class="cost-icon">ğŸ’°</span>
                            <span>450 é‡‘å¹£</span>
                        </span>
                    </button>
                </div>

                <!-- å°„é€Ÿå‡ç´šå¡ -->
                <div class="upgrade-card">
                    <div class="upgrade-header">
                        <span class="upgrade-name">ğŸ”« å°„é€Ÿ</span>
                        <span class="upgrade-level">Lv.2</span>
                    </div>
                    <div class="upgrade-stats">
                        <div class="upgrade-stat">
                            <span>ç•¶å‰å€¼</span>
                            <span class="current-value">5 ç™¼/ç§’</span>
                        </div>
                        <div class="upgrade-stat">
                            <span>å‡ç´šå¾Œ</span>
                            <span class="next-value">+1 â†’ 6 ç™¼/ç§’</span>
                        </div>
                    </div>
                    <div class="upgrade-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 40%;"></div>
                        </div>
                    </div>
                    <button class="upgrade-btn">
                        <span class="upgrade-cost">
                            <span class="cost-icon">ğŸ’°</span>
                            <span>400 é‡‘å¹£</span>
                        </span>
                    </button>
                </div>

                <!-- ç§»å‹•é€Ÿåº¦å‡ç´šå¡ -->
                <div class="upgrade-card">
                    <div class="upgrade-header">
                        <span class="upgrade-name">ğŸš€ ç§»å‹•é€Ÿåº¦</span>
                        <span class="upgrade-level">Lv.3</span>
                    </div>
                    <div class="upgrade-stats">
                        <div class="upgrade-stat">
                            <span>ç•¶å‰å€¼</span>
                            <span class="current-value">300 åƒç´ /ç§’</span>
                        </div>
                        <div class="upgrade-stat">
                            <span>å‡ç´šå¾Œ</span>
                            <span class="next-value">+50 â†’ 350 åƒç´ /ç§’</span>
                        </div>
                    </div>
                    <div class="upgrade-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 60%;"></div>
                        </div>
                    </div>
                    <button class="upgrade-btn">
                        <span class="upgrade-cost">
                            <span class="cost-icon">ğŸ’°</span>
                            <span>350 é‡‘å¹£</span>
                        </span>
                    </button>
                </div>

                <!-- è­·ç›¾å‡ç´šå¡ -->
                <div class="upgrade-card">
                    <div class="upgrade-header">
                        <span class="upgrade-name">ğŸ›¡ï¸ è­·ç›¾</span>
                        <span class="upgrade-level">Lv.1</span>
                    </div>
                    <div class="upgrade-stats">
                        <div class="upgrade-stat">
                            <span>ç•¶å‰å€¼</span>
                            <span class="current-value">50 HP</span>
                        </div>
                        <div class="upgrade-stat">
                            <span>å‡ç´šå¾Œ</span>
                            <span class="next-value">+25 â†’ 75 HP</span>
                        </div>
                    </div>
                    <div class="upgrade-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 20%;"></div>
                        </div>
                    </div>
                    <button class="upgrade-btn">
                        <span class="upgrade-cost">
                            <span class="cost-icon">ğŸ’°</span>
                            <span>500 é‡‘å¹£</span>
                        </span>
                    </button>
                </div>

                <!-- æš´æ“Šç‡å‡ç´šå¡ -->
                <div class="upgrade-card">
                    <div class="upgrade-header">
                        <span class="upgrade-name">ğŸ’¥ æš´æ“Šç‡</span>
                        <span class="upgrade-level">Lv.2</span>
                    </div>
                    <div class="upgrade-stats">
                        <div class="upgrade-stat">
                            <span>ç•¶å‰å€¼</span>
                            <span class="current-value">10%</span>
                        </div>
                        <div class="upgrade-stat">
                            <span>å‡ç´šå¾Œ</span>
                            <span class="next-value">+5% â†’ 15%</span>
                        </div>
                    </div>
                    <div class="upgrade-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 40%;"></div>
                        </div>
                    </div>
                    <button class="upgrade-btn" disabled>
                        <span class="upgrade-cost">
                            <span class="cost-icon">ğŸ’°</span>
                            <span>8000 é‡‘å¹£ï¼ˆé‡‘å¹£ä¸è¶³ï¼‰</span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ­¦å™¨é¸æ“‡å°è©±æ¡† -->
    <div id="weapon-dialog" class="dialog-overlay">
        <div class="dialog-box">
            <div class="dialog-header">
                <h3 class="dialog-title">ğŸ”« é¸æ“‡æ­¦å™¨</h3>
                <button class="dialog-close" onclick="closeWeaponDialog()">âœ•</button>
            </div>
            <div class="dialog-content" id="weapon-options">
                <!-- æ­¦å™¨é¸é …å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
            <div class="dialog-footer">
                <button class="dialog-btn dialog-btn-secondary" onclick="closeWeaponDialog()">å–æ¶ˆ</button>
                <button class="dialog-btn dialog-btn-primary" onclick="confirmWeaponSelection()">ç¢ºèª</button>
            </div>
        </div>
    </div>

    <!-- ç‚®å¡”é¸æ“‡å°è©±æ¡† -->
    <div id="tower-dialog" class="dialog-overlay">
        <div class="dialog-box">
            <div class="dialog-header">
                <h3 class="dialog-title">ğŸ—ï¸ é¸æ“‡ç‚®å¡”</h3>
                <button class="dialog-close" onclick="closeTowerDialog()">âœ•</button>
            </div>
            <div class="dialog-content" id="tower-options">
                <!-- ç‚®å¡”é¸é …å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
            <div class="dialog-footer">
                <button class="dialog-btn dialog-btn-secondary" onclick="closeTowerDialog()">å–æ¶ˆ</button>
                <button class="dialog-btn dialog-btn-primary" onclick="confirmTowerSelection()">ç¢ºèª</button>
            </div>
        </div>
    </div>

    <script>
        // ===== é…ç½®æ•¸æ“š =====
        const WEAPON_DATA = {
            vulcan: {
                id: 'vulcan',
                name: 'Vulcan',
                icon: 'ğŸ”«',
                description: 'å¿«é€Ÿé€£ç™¼æ©Ÿæ§',
                damage: 20,
                ammo: 'âˆ',
                fireRate: 150,
                unlocked: true
            },
            missile: {
                id: 'missile',
                name: 'Missile',
                icon: 'ğŸš€',
                description: 'è¿½è¹¤æ•µäººçš„å°å½ˆ',
                damage: 100,
                ammo: 3,
                cooldown: 5,
                unlocked: true
            },
            bomb: {
                id: 'bomb',
                name: 'Bomb',
                icon: 'ğŸ’£',
                description: 'å¤§ç¯„åœçˆ†ç‚¸ç‚¸å½ˆ',
                damage: 200,
                ammo: 1,
                cooldown: 10,
                unlocked: true
            }
        };

        const TOWER_DATA = {
            basic: {
                id: 'basic',
                name: 'Gatling',
                icon: 'ğŸ¯',
                description: 'å¿«é€Ÿå°„æ“Šç‚®å¡”',
                damage: 25,
                uses: 5,
                range: 120,
                unlocked: true
            },
            cannon: {
                id: 'cannon',
                name: 'Striker',
                icon: 'ğŸ’¥',
                description: 'ç¯„åœçˆ†ç‚¸å‚·å®³',
                damage: 80,
                uses: 5,
                range: 100,
                unlocked: true
            },
            laser: {
                id: 'laser',
                name: 'Railgun',
                icon: 'âš¡',
                description: 'é«˜ç²¾æº–èƒ½é‡æ­¦å™¨',
                damage: 40,
                uses: 5,
                range: 150,
                unlocked: true
            },
            ice: {
                id: 'ice',
                name: 'Frost',
                icon: 'â„ï¸',
                description: 'æ¸›ç·©æ•µäººé€Ÿåº¦',
                damage: 20,
                uses: 5,
                range: 130,
                unlocked: true
            }
        };

        // ===== å…¨å±€ç‹€æ…‹ =====
        let currentLoadout = {
            weapons: ['vulcan', 'missile', 'bomb'],
            towers: ['basic', 'cannon', 'laser']
        };

        let currentEditingSlot = null;
        let currentEditingType = null;
        let tempSelection = null;

        // ===== åˆå§‹åŒ– =====
        function init() {
            loadSavedLoadout();
            renderWeaponLoadout();
            renderTowerLoadout();
            loadPlayerData();
            
            // ä¿ç•™åŸæœ‰çš„å‡ç´šæŒ‰éˆ•åŠŸèƒ½
            document.querySelectorAll('.upgrade-btn:not(:disabled)').forEach(btn => {
                btn.addEventListener('click', function() {
                    alert('å‡ç´šåŠŸèƒ½é–‹ç™¼ä¸­ï¼\n\næœªä¾†å°‡èˆ‡éŠæˆ²è³‡æ–™é€£å‹•ï¼Œå¯¦ç¾çœŸæ­£çš„å‡ç´šåŠŸèƒ½ã€‚');
                });
            });
        }

        // ===== è®€å–ä¿å­˜çš„é…ç½® =====
        function loadSavedLoadout() {
            const saved = localStorage.getItem('playerShipConfig');
            if (saved) {
                try {
                    const config = JSON.parse(saved);
                    if (config.weaponSlots) {
                        currentLoadout.weapons = config.weaponSlots.map(slot => slot.weaponId);
                    }
                    if (config.towerSlots) {
                        currentLoadout.towers = config.towerSlots.map(slot => slot.towerId);
                    }
                } catch (e) {
                    console.error('è¼‰å…¥é…ç½®å¤±æ•—:', e);
                }
            }
        }

        // ===== ä¿å­˜é…ç½® =====
        function saveLoadout() {
            const config = {
                weaponSlots: currentLoadout.weapons.map((weaponId, index) => ({
                    slotId: index,
                    weaponId: weaponId
                })),
                towerSlots: currentLoadout.towers.map((towerId, index) => ({
                    slotId: index,
                    towerId: towerId,
                    count: 5
                }))
            };
            localStorage.setItem('playerShipConfig', JSON.stringify(config));
            console.log('âœ… é…ç½®å·²ä¿å­˜:', config);
        }

        // ===== æ¸²æŸ“æ­¦å™¨è£å‚™æ§½ =====
        function renderWeaponLoadout() {
            const container = document.getElementById('weapon-loadout');
            container.innerHTML = '';
            
            currentLoadout.weapons.forEach((weaponId, index) => {
                const weapon = WEAPON_DATA[weaponId];
                if (!weapon) return;
                
                const slotHTML = `
                    <div class="loadout-slot" onclick="openWeaponDialog(${index})">
                        <div class="slot-number">${index + 1}</div>
                        <div class="slot-icon">${weapon.icon}</div>
                        <div class="slot-name">${weapon.name}</div>
                        <div class="slot-stats">
                            <div class="slot-stat-item">
                                <span>å‚·å®³</span>
                                <span style="color: #ff6b6b;">${weapon.damage}</span>
                            </div>
                            <div class="slot-stat-item">
                                <span>å½ˆè—¥</span>
                                <span style="color: #ffd93d;">${weapon.ammo}</span>
                            </div>
                            ${weapon.cooldown ? `
                            <div class="slot-stat-item">
                                <span>å†·å»</span>
                                <span style="color: #51cf66;">${weapon.cooldown}ç§’</span>
                            </div>
                            ` : ''}
                        </div>
                        <button class="change-btn" onclick="openWeaponDialog(${index}); event.stopPropagation();">
                            æ›´æ›æ­¦å™¨ â–¼
                        </button>
                    </div>
                `;
                container.innerHTML += slotHTML;
            });
        }

        // ===== æ¸²æŸ“ç‚®å¡”è£å‚™æ§½ =====
        function renderTowerLoadout() {
            const container = document.getElementById('tower-loadout');
            container.innerHTML = '';
            
            currentLoadout.towers.forEach((towerId, index) => {
                const tower = TOWER_DATA[towerId];
                if (!tower) return;
                
                const slotHTML = `
                    <div class="loadout-slot" onclick="openTowerDialog(${index})">
                        <div class="slot-number">${index + 1}</div>
                        <div class="slot-icon">${tower.icon}</div>
                        <div class="slot-name">${tower.name}</div>
                        <div class="slot-stats">
                            <div class="slot-stat-item">
                                <span>å‚·å®³</span>
                                <span style="color: #ff6b6b;">${tower.damage}</span>
                            </div>
                            <div class="slot-stat-item">
                                <span>ä½¿ç”¨æ¬¡æ•¸</span>
                                <span style="color: #ffd93d;">Ã—${tower.uses}</span>
                            </div>
                            <div class="slot-stat-item">
                                <span>å°„ç¨‹</span>
                                <span style="color: #51cf66;">${tower.range}</span>
                            </div>
                        </div>
                        <button class="change-btn" onclick="openTowerDialog(${index}); event.stopPropagation();">
                            æ›´æ›ç‚®å¡” â–¼
                        </button>
                    </div>
                `;
                container.innerHTML += slotHTML;
            });
        }

        // ===== æ‰“é–‹æ­¦å™¨é¸æ“‡å°è©±æ¡† =====
        function openWeaponDialog(slotIndex) {
            currentEditingSlot = slotIndex;
            currentEditingType = 'weapon';
            tempSelection = currentLoadout.weapons[slotIndex];
            
            const container = document.getElementById('weapon-options');
            container.innerHTML = '';
            
            Object.values(WEAPON_DATA).forEach(weapon => {
                const isSelected = weapon.id === tempSelection;
                const isEquipped = currentLoadout.weapons.includes(weapon.id);
                
                const optionHTML = `
                    <div class="option-item ${isSelected ? 'selected' : ''} ${!weapon.unlocked ? 'locked' : ''}" 
                         onclick="${weapon.unlocked ? `selectWeapon('${weapon.id}')` : ''}">
                        <div class="option-icon">${weapon.icon}</div>
                        <div class="option-details">
                            <div class="option-name">${weapon.name}</div>
                            <div class="option-desc">${weapon.description}</div>
                            <div class="option-stats">
                                <span>å‚·å®³: ${weapon.damage}</span>
                                <span>å½ˆè—¥: ${weapon.ammo}</span>
                                ${weapon.fireRate ? `<span>å°„é€Ÿ: ${weapon.fireRate}ms</span>` : ''}
                            </div>
                        </div>
                        ${isEquipped ? '<span class="option-badge">å·²è£å‚™</span>' : ''}
                        ${isSelected ? '<span class="option-badge">âœ“</span>' : ''}
                        ${!weapon.unlocked ? '<span class="option-badge locked">ğŸ”’ æœªè§£é–</span>' : ''}
                    </div>
                `;
                container.innerHTML += optionHTML;
            });
            
            document.getElementById('weapon-dialog').classList.add('active');
        }

        // ===== é¸æ“‡æ­¦å™¨ =====
        function selectWeapon(weaponId) {
            tempSelection = weaponId;
            
            // æ›´æ–° UI é¸ä¸­ç‹€æ…‹
            document.querySelectorAll('#weapon-options .option-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        // ===== ç¢ºèªæ­¦å™¨é¸æ“‡ =====
        function confirmWeaponSelection() {
            if (tempSelection && currentEditingSlot !== null) {
                currentLoadout.weapons[currentEditingSlot] = tempSelection;
                saveLoadout();
                renderWeaponLoadout();
                closeWeaponDialog();
            }
        }

        // ===== é—œé–‰æ­¦å™¨å°è©±æ¡† =====
        function closeWeaponDialog() {
            document.getElementById('weapon-dialog').classList.remove('active');
            currentEditingSlot = null;
            tempSelection = null;
        }

        // ===== æ‰“é–‹ç‚®å¡”é¸æ“‡å°è©±æ¡† =====
        function openTowerDialog(slotIndex) {
            currentEditingSlot = slotIndex;
            currentEditingType = 'tower';
            tempSelection = currentLoadout.towers[slotIndex];
            
            const container = document.getElementById('tower-options');
            container.innerHTML = '';
            
            Object.values(TOWER_DATA).forEach(tower => {
                const isSelected = tower.id === tempSelection;
                const isEquipped = currentLoadout.towers.includes(tower.id);
                
                const optionHTML = `
                    <div class="option-item ${isSelected ? 'selected' : ''} ${!tower.unlocked ? 'locked' : ''}" 
                         onclick="${tower.unlocked ? `selectTower('${tower.id}')` : ''}">
                        <div class="option-icon">${tower.icon}</div>
                        <div class="option-details">
                            <div class="option-name">${tower.name}</div>
                            <div class="option-desc">${tower.description}</div>
                            <div class="option-stats">
                                <span>å‚·å®³: ${tower.damage}</span>
                                <span>ä½¿ç”¨: Ã—${tower.uses}</span>
                                <span>å°„ç¨‹: ${tower.range}</span>
                            </div>
                        </div>
                        ${isEquipped ? '<span class="option-badge">å·²è£å‚™</span>' : ''}
                        ${isSelected ? '<span class="option-badge">âœ“</span>' : ''}
                        ${!tower.unlocked ? '<span class="option-badge locked">ğŸ”’ æœªè§£é–</span>' : ''}
                    </div>
                `;
                container.innerHTML += optionHTML;
            });
            
            document.getElementById('tower-dialog').classList.add('active');
        }

        // ===== é¸æ“‡ç‚®å¡” =====
        function selectTower(towerId) {
            tempSelection = towerId;
            
            // æ›´æ–° UI é¸ä¸­ç‹€æ…‹
            document.querySelectorAll('#tower-options .option-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        // ===== ç¢ºèªç‚®å¡”é¸æ“‡ =====
        function confirmTowerSelection() {
            if (tempSelection && currentEditingSlot !== null) {
                currentLoadout.towers[currentEditingSlot] = tempSelection;
                saveLoadout();
                renderTowerLoadout();
                closeTowerDialog();
            }
        }

        // ===== é—œé–‰ç‚®å¡”å°è©±æ¡† =====
        function closeTowerDialog() {
            document.getElementById('tower-dialog').classList.remove('active');
            currentEditingSlot = null;
            tempSelection = null;
        }

        // ===== è®€å–ç©å®¶æ•¸æ“š =====
        function loadPlayerData() {
            const savedData = localStorage.getItem('playerData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    document.getElementById('player-money').textContent = data.money || 5000;
                    document.getElementById('total-level').textContent = data.level || 12;
                    document.getElementById('wins').textContent = data.wins || 25;
                    document.getElementById('kills').textContent = data.kills || 1547;
                } catch (e) {
                    console.error('è¼‰å…¥ç©å®¶æ•¸æ“šå¤±æ•—:', e);
                }
            }
        }

        // ===== é é¢è¼‰å…¥æ™‚åˆå§‹åŒ– =====
        window.addEventListener('load', init);

        // ===== é—œé–‰å°è©±æ¡†ï¼ˆé»æ“ŠèƒŒæ™¯ï¼‰ =====
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('dialog-overlay')) {
                closeWeaponDialog();
                closeTowerDialog();
            }
        });
    </script>
</body>
</html>




