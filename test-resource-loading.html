<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³‡æºåŠ è¼‰æ¸¬è©¦</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #222;
            color: white;
            font-family: Arial, sans-serif;
        }
        #game-container {
            border: 2px solid #444;
            margin: 20px 0;
        }
        .info {
            background: #333;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
    </style>
</head>
<body>
    <h1>è³‡æºåŠ è¼‰æ¸¬è©¦</h1>
    
    <div class="info">
        <h3>æ¸¬è©¦ç›®æ¨™ï¼š</h3>
        <ul>
            <li>âœ… åœ¨ preload() éšæ®µåŠ è¼‰æ‰€æœ‰è³‡æº</li>
            <li>âœ… é©—è­‰ tower-sprites åœ–é›†æ˜¯å¦æ­£ç¢ºåŠ è¼‰</li>
            <li>âœ… æª¢æŸ¥æ‰€æœ‰ frame æ˜¯å¦å¯ç”¨</li>
            <li>âœ… æ¸¬è©¦å¡”å¡ç‰‡é¡¯ç¤º</li>
        </ul>
    </div>

    <div id="game-container"></div>

    <div class="info">
        <h3>æ§åˆ¶å°æ—¥èªŒï¼š</h3>
        <p>è«‹æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·æŸ¥çœ‹è©³ç´°çš„åŠ è¼‰æ—¥èªŒ</p>
    </div>

    <script src="node_modules/phaser/dist/phaser.min.js"></script>
    <script>
        class ResourceLoadingTestScene extends Phaser.Scene {
            constructor() {
                super({ key: 'ResourceLoadingTestScene' });
            }

            preload() {
                console.log('ğŸ”„ é–‹å§‹ preload() éšæ®µ...');
                
                // è¼‰å…¥å¡”ç²¾éˆåœ–é›†
                this.load.atlas('tower-sprites', 'assets/sprites/towers/tower-sprite.png', 'assets/sprites/towers/tower-sprite.json');
                
                // è¼‰å…¥æ•µäººç²¾éˆåœ–é›†
                this.load.atlas('enemy-sprites', 'assets/sprites/enemies/enemy-sprite.png', 'assets/sprites/enemies/enemy-sprite.json');
                
                console.log('ğŸ“ preload() éšæ®µå®Œæˆ');
            }

            create() {
                console.log('ğŸ® é–‹å§‹ create() éšæ®µ...');
                
                // å‰µå»ºèƒŒæ™¯
                this.add.rectangle(640, 400, 1280, 800, 0x2c3e50);
                
                // æª¢æŸ¥è³‡æºæ˜¯å¦æ­£ç¢ºåŠ è¼‰
                this.checkResources();
                
                // å‰µå»ºå¡”å¡ç‰‡æ¸¬è©¦
                this.createTowerCardTest();
                
                console.log('âœ… create() éšæ®µå®Œæˆ');
            }
            
            checkResources() {
                console.log('ğŸ” æª¢æŸ¥è³‡æºåŠ è¼‰ç‹€æ…‹...');
                
                // æª¢æŸ¥ tower-sprites åœ–é›†
                if (this.textures.exists('tower-sprites')) {
                    console.log('âœ… tower-sprites åœ–é›†å·²åŠ è¼‰');
                    
                    // æª¢æŸ¥æ‰€æœ‰ frame
                    const frames = [
                        'basic-tower.png',
                        'canon-tower.png', 
                        'laser-tower.png',
                        'ice-tower.png',
                        'basic-tower-card.png',
                        'canon-tower-card.png',
                        'laser-tower-card.png',
                        'ice-tower-card.png'
                    ];
                    
                    frames.forEach(frameName => {
                        if (this.textures.get('tower-sprites').has(frameName)) {
                            console.log(`âœ… Frame "${frameName}" å¯ç”¨`);
                        } else {
                            console.error(`âŒ Frame "${frameName}" ä¸å¯ç”¨`);
                        }
                    });
                } else {
                    console.error('âŒ tower-sprites åœ–é›†æœªåŠ è¼‰');
                }
                
                // æª¢æŸ¥ enemy-sprites åœ–é›†
                if (this.textures.exists('enemy-sprites')) {
                    console.log('âœ… enemy-sprites åœ–é›†å·²åŠ è¼‰');
                } else {
                    console.error('âŒ enemy-sprites åœ–é›†æœªåŠ è¼‰');
                }
            }
            
            createTowerCardTest() {
                console.log('ğŸ´ å‰µå»ºå¡”å¡ç‰‡æ¸¬è©¦...');
                
                const cardFrames = [
                    'basic-tower-card.png',
                    'canon-tower-card.png',
                    'laser-tower-card.png',
                    'ice-tower-card.png'
                ];
                
                const cardNames = ['åŸºç¤å¡”', 'åŠ è¾²ç‚®', 'æ¿€å…‰å¡”', 'å†°å‡å¡”'];
                
                cardFrames.forEach((frameName, index) => {
                    const x = 200 + index * 200;
                    const y = 300;
                    
                    // å‰µå»ºå¡ç‰‡
                    const card = this.add.image(x, y, 'tower-sprites', frameName);
                    card.setScale(0.8);
                    
                    // å‰µå»ºæ¨™ç±¤
                    const label = this.add.text(x, y + 80, cardNames[index], {
                        fontSize: '16px',
                        fill: '#ffffff',
                        backgroundColor: '#000000',
                        padding: { x: 8, y: 4 }
                    });
                    label.setOrigin(0.5);
                    
                    // æ·»åŠ  hover æ•ˆæœ
                    card.setInteractive();
                    card.on('pointerover', () => {
                        card.setScale(0.9);
                        card.setTint(0x00ff00);
                    });
                    card.on('pointerout', () => {
                        card.setScale(0.8);
                        card.clearTint();
                    });
                    
                    console.log(`âœ… å‰µå»ºå¡ç‰‡: ${cardNames[index]} (${frameName})`);
                });
            }
        }

        const config = {
            type: Phaser.AUTO,
            width: 1280,
            height: 800,
            parent: 'game-container',
            backgroundColor: '#2c3e50',
            scene: ResourceLoadingTestScene
        };

        const game = new Phaser.Game(config);
    </script>
</body>
</html>
